import sys
sys.path.append("..")
import numpy as np
from osc import sine, sawtooth, noise
from env import adsr, cos_env
from biquad import biquad_filter
from effect import reverb
from instruments.strings import (
    plucked_string_excitation,
    plucked_string_delay_feedback,
    plucked_string_comb_filter,
    plucked_string_frequency_filter,
    plucked_string_part
)
from instruments.utils import calc_freq, calc_delayar


def pipe_organ(note_no: int, velocity: int, gate: float, duration: float, sr: int =44100,
               enable_reverb: bool =True) -> np.ndarray:
    N_PARTIAL: int = 15
    freq: float = calc_freq(note_no)
    vcos: np.ndarray = np.tile(
        freq*np.array([0.5, 1, 1.5, 2, 2.5, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12])[:np.newaxis], int(duration * sr)
    )
    vca_delays: np.ndarray = calc_delayar(vcos, p1=0, p2=-0.05, p3=8000/12, p4=0.1, is_delay=True)
    vca_as: np.ndarray = calc_delayar(vcos, p1=0, p2=0.05, p3=8000/12, p4=0.1, is_sub=True)
    vca_rs: np.ndarray = calc_delayar(vcos, p1=0, p2=0.2, p3=8000/12, p4=0.4, is_sub=True)
    vca_depths: np.ndarray = np.array([0.30, 0.60, 0.30, 0.85, 0.25, 0.50, 0.95, 0.25, 0.50, 0.15,
                                       0.95, 0.00, 0.25, 0.00, 0.50])

    z: np.ndarray = np.zeros(int(duration*sr))
    for i in range(N_PARTIAL):
        jitter: np.ndarray = biquad_filter(noise(sec=duration, sr=sr), filter_type="lowpass",
                                           fc=40, Q=1/np.sqrt(2), sr=sr)
        jitter = calc_delayar(note_no, p1=108, p2=0.2, p3=120/12, p4=4) / np.max(np.abs(jitter)) * jitter
        shimmer: np.ndarray = biquad_filter(noise(sec=duration, sr=sr), filter_type="lowpass",
                                            fc=40, Q=1/np.sqrt(2), sr=sr)
        shimmer = calc_delayar(vcos[i], p1=1, p2=-0.05, p3=100/12, p4=0.2) / np.max(np.abs(shimmer)) * shimmer
        vca: np.ndarray = vca_depths[i] \
                        * cos_env(delay=vca_delays[i], A=vca_as[i], S=1, R=vca_rs[i], gate=gate, dur=duration, sr=sr)
        vca = np.maximum((1 + shimmer) * vca, 0)
        z += vca * sine(vcos[i], sec=duration, sr=sr)
    z = (velocity / 127) / np.max(np.abs(z)) * z
    return reverb(z, reverb_time=2, level=0.1, sr=sr) if enable_reverb else z


def read_organ(note_no: int, velocity: int, gate: float, duration: float, sr: int =44100) -> np.ndarray:
    freq: float = calc_freq(note_no)
    vco: np.ndarray = freq * np.ones(int(duration*sr))
    vca: np.ndarray = adsr(A=0.5, D=0, S=1, R=0.2, gate=gate, dur=duration, sr=sr)
    z: np.ndarray = sawtooth(vco, sec=duration, sr=sr)
    z = vca * biquad_filter(z, filter_type="lowpass", fc=500, Q=1/np.sqrt(2), sr=sr)
    return (velocity / 127) / np.max(np.abs(z)) * z


def harpsichord(note_no: int, velocity: int, gate: float, duration: float, sr: int =44100) -> np.ndarray:
    WIN_LEN: int = 128
    LOWEST_NOTE_NO: int = 41
    freq: float = calc_freq(note_no)

    # feedback filter
    d: float = calc_delayar(note_no, p1=30, p2=0, p3=120/12, p4=0.5, is_sub=True)
    fbk_decay: float = calc_delayar(note_no, p1=75, p2=0, p3=120/12, p4=20, is_sub=True)
    c: float = np.minimum(
        np.power(10, -3/freq/fbk_decay) / np.sqrt((1 - d) ** 2 + 2 * d * (1 - d) * np.cos(2 * np.pi * freq / sr) + d ** 2),
        1
    )

    # delayline
    n_delay: int = int(sr / freq - d)
    f_delay: float = sr / freq - d - n_delay
    apf_coef: float = (1 - f_delay) / (1 + f_delay)

    # Karplus-Strong string synthesis
    excitation: np.ndarray = np.array([
        0.10, 0.10, 0.10, 0.10, 0.10, 0.11, 0.11, 0.11, 0.11, 0.11,
        0.12, 0.12, 0.12, 0.13, 0.13, 0.13, 0.14, 0.14, 0.15, 0.15,
        0.16, 0.16, 0.17, 0.17, 0.18, 0.19, 0.19, 0.20, 0.21, 0.22,
        0.23, 0.24, 0.25, 0.26, 0.27, 0.28, 0.30, 0.31, 0.32, 0.34,
        0.35, 0.37, 0.39, 0.40, 0.42, 0.44, 0.46, 0.48, 0.50
    ])
    z = plucked_string_excitation(freq, n_delay+WIN_LEN, duration, sr)
    z = plucked_string_delay_feedback(z, WIN_LEN, n_delay, apf_coef, c, d, duration, sr)
    z = plucked_string_comb_filter(z, freq, excitation[note_no-LOWEST_NOTE_NO], n_delay, duration, sr)

    # frequency filtering
    N_FFT: int = 4096
    N_BAND: int = 64
    amps: np.ndarray = np.array([
        [0.041661, 0.042592, 0.072654, 0.204266, 0.568685, 1.000000, 0.419720, 0.220019, 0.495519, 0.199545, 0.070834, 0.164315, 0.147530, 0.154276, 0.116741, 0.121176, 0.091007, 0.067478, 0.042546, 0.073123, 0.068860, 0.053839, 0.029921, 0.029768, 0.029465, 0.061012, 0.045171, 0.090820, 0.070394, 0.054073, 0.063202, 0.033421, 0.028364, 0.036574, 0.045538, 0.051262, 0.038076, 0.033794, 0.020677, 0.070303, 0.063244, 0.060428, 0.038189, 0.038606, 0.042050, 0.038997, 0.035323, 0.029665, 0.033907, 0.038288, 0.017471, 0.031069, 0.030238, 0.025735, 0.020350, 0.014198, 0.012919, 0.012094, 0.010160, 0.010514, 0.005527, 0.006399, 0.004232, 0.002667],
        [0.041661, 0.042592, 0.072654, 0.204266, 0.568685, 1.000000, 0.419720, 0.220019, 0.495519, 0.199545, 0.070834, 0.164315, 0.147530, 0.154276, 0.116741, 0.121176, 0.091007, 0.067478, 0.042546, 0.073123, 0.068860, 0.053839, 0.029921, 0.029768, 0.029465, 0.061012, 0.045171, 0.090820, 0.070394, 0.054073, 0.063202, 0.033421, 0.028364, 0.036574, 0.045538, 0.051262, 0.038076, 0.033794, 0.020677, 0.070303, 0.063244, 0.060428, 0.038189, 0.038606, 0.042050, 0.038997, 0.035323, 0.029665, 0.033907, 0.038288, 0.017471, 0.031069, 0.030238, 0.025735, 0.020350, 0.014198, 0.012919, 0.012094, 0.010160, 0.010514, 0.005527, 0.006399, 0.004232, 0.002667],
        [0.041661, 0.042592, 0.072654, 0.204266, 0.568685, 1.000000, 0.419720, 0.220019, 0.495519, 0.199545, 0.070834, 0.164315, 0.147530, 0.154276, 0.116741, 0.121176, 0.091007, 0.067478, 0.042546, 0.073123, 0.068860, 0.053839, 0.029921, 0.029768, 0.029465, 0.061012, 0.045171, 0.090820, 0.070394, 0.054073, 0.063202, 0.033421, 0.028364, 0.036574, 0.045538, 0.051262, 0.038076, 0.033794, 0.020677, 0.070303, 0.063244, 0.060428, 0.038189, 0.038606, 0.042050, 0.038997, 0.035323, 0.029665, 0.033907, 0.038288, 0.017471, 0.031069, 0.030238, 0.025735, 0.020350, 0.014198, 0.012919, 0.012094, 0.010160, 0.010514, 0.005527, 0.006399, 0.004232, 0.002667],
        [0.041661, 0.042592, 0.072654, 0.204266, 0.568685, 1.000000, 0.419720, 0.220019, 0.495519, 0.199545, 0.070834, 0.164315, 0.147530, 0.154276, 0.116741, 0.121176, 0.091007, 0.067478, 0.042546, 0.073123, 0.068860, 0.053839, 0.029921, 0.029768, 0.029465, 0.061012, 0.045171, 0.090820, 0.070394, 0.054073, 0.063202, 0.033421, 0.028364, 0.036574, 0.045538, 0.051262, 0.038076, 0.033794, 0.020677, 0.070303, 0.063244, 0.060428, 0.038189, 0.038606, 0.042050, 0.038997, 0.035323, 0.029665, 0.033907, 0.038288, 0.017471, 0.031069, 0.030238, 0.025735, 0.020350, 0.014198, 0.012919, 0.012094, 0.010160, 0.010514, 0.005527, 0.006399, 0.004232, 0.002667],
        [0.041661, 0.042592, 0.072654, 0.204266, 0.568685, 1.000000, 0.419720, 0.220019, 0.495519, 0.199545, 0.070834, 0.164315, 0.147530, 0.154276, 0.116741, 0.121176, 0.091007, 0.067478, 0.042546, 0.073123, 0.068860, 0.053839, 0.029921, 0.029768, 0.029465, 0.061012, 0.045171, 0.090820, 0.070394, 0.054073, 0.063202, 0.033421, 0.028364, 0.036574, 0.045538, 0.051262, 0.038076, 0.033794, 0.020677, 0.070303, 0.063244, 0.060428, 0.038189, 0.038606, 0.042050, 0.038997, 0.035323, 0.029665, 0.033907, 0.038288, 0.017471, 0.031069, 0.030238, 0.025735, 0.020350, 0.014198, 0.012919, 0.012094, 0.010160, 0.010514, 0.005527, 0.006399, 0.004232, 0.002667],
        [0.041661, 0.042592, 0.072654, 0.204266, 0.568685, 1.000000, 0.419720, 0.220019, 0.495519, 0.199545, 0.070834, 0.164315, 0.147530, 0.154276, 0.116741, 0.121176, 0.091007, 0.067478, 0.042546, 0.073123, 0.068860, 0.053839, 0.029921, 0.029768, 0.029465, 0.061012, 0.045171, 0.090820, 0.070394, 0.054073, 0.063202, 0.033421, 0.028364, 0.036574, 0.045538, 0.051262, 0.038076, 0.033794, 0.020677, 0.070303, 0.063244, 0.060428, 0.038189, 0.038606, 0.042050, 0.038997, 0.035323, 0.029665, 0.033907, 0.038288, 0.017471, 0.031069, 0.030238, 0.025735, 0.020350, 0.014198, 0.012919, 0.012094, 0.010160, 0.010514, 0.005527, 0.006399, 0.004232, 0.002667],
        [0.041661, 0.042592, 0.072654, 0.204266, 0.568685, 1.000000, 0.419720, 0.220019, 0.495519, 0.199545, 0.070834, 0.164315, 0.147530, 0.154276, 0.116741, 0.121176, 0.091007, 0.067478, 0.042546, 0.073123, 0.068860, 0.053839, 0.029921, 0.029768, 0.029465, 0.061012, 0.045171, 0.090820, 0.070394, 0.054073, 0.063202, 0.033421, 0.028364, 0.036574, 0.045538, 0.051262, 0.038076, 0.033794, 0.020677, 0.070303, 0.063244, 0.060428, 0.038189, 0.038606, 0.042050, 0.038997, 0.035323, 0.029665, 0.033907, 0.038288, 0.017471, 0.031069, 0.030238, 0.025735, 0.020350, 0.014198, 0.012919, 0.012094, 0.010160, 0.010514, 0.005527, 0.006399, 0.004232, 0.002667],
        [0.200378, 0.282013, 0.542122, 0.937123, 1.000000, 0.669833, 0.359089, 0.272836, 0.357189, 0.526830, 0.503286, 0.312226, 0.179440, 0.109140, 0.068114, 0.073872, 0.125688, 0.109209, 0.063483, 0.078976, 0.074902, 0.048985, 0.061145, 0.044165, 0.046876, 0.039973, 0.057835, 0.029931, 0.040996, 0.045161, 0.050566, 0.042235, 0.032082, 0.020011, 0.037255, 0.077936, 0.047181, 0.037362, 0.035730, 0.035150, 0.045436, 0.050355, 0.044337, 0.078095, 0.041606, 0.055516, 0.046250, 0.031578, 0.053856, 0.034707, 0.036807, 0.031010, 0.027231, 0.035225, 0.046270, 0.019425, 0.022486, 0.021249, 0.011158, 0.009750, 0.012357, 0.011702, 0.008706, 0.004675],
        [0.200378, 0.282013, 0.542122, 0.937123, 1.000000, 0.669833, 0.359089, 0.272836, 0.357189, 0.526830, 0.503286, 0.312226, 0.179440, 0.109140, 0.068114, 0.073872, 0.125688, 0.109209, 0.063483, 0.078976, 0.074902, 0.048985, 0.061145, 0.044165, 0.046876, 0.039973, 0.057835, 0.029931, 0.040996, 0.045161, 0.050566, 0.042235, 0.032082, 0.020011, 0.037255, 0.077936, 0.047181, 0.037362, 0.035730, 0.035150, 0.045436, 0.050355, 0.044337, 0.078095, 0.041606, 0.055516, 0.046250, 0.031578, 0.053856, 0.034707, 0.036807, 0.031010, 0.027231, 0.035225, 0.046270, 0.019425, 0.022486, 0.021249, 0.011158, 0.009750, 0.012357, 0.011702, 0.008706, 0.004675],
        [0.200378, 0.282013, 0.542122, 0.937123, 1.000000, 0.669833, 0.359089, 0.272836, 0.357189, 0.526830, 0.503286, 0.312226, 0.179440, 0.109140, 0.068114, 0.073872, 0.125688, 0.109209, 0.063483, 0.078976, 0.074902, 0.048985, 0.061145, 0.044165, 0.046876, 0.039973, 0.057835, 0.029931, 0.040996, 0.045161, 0.050566, 0.042235, 0.032082, 0.020011, 0.037255, 0.077936, 0.047181, 0.037362, 0.035730, 0.035150, 0.045436, 0.050355, 0.044337, 0.078095, 0.041606, 0.055516, 0.046250, 0.031578, 0.053856, 0.034707, 0.036807, 0.031010, 0.027231, 0.035225, 0.046270, 0.019425, 0.022486, 0.021249, 0.011158, 0.009750, 0.012357, 0.011702, 0.008706, 0.004675],
        [0.200378, 0.282013, 0.542122, 0.937123, 1.000000, 0.669833, 0.359089, 0.272836, 0.357189, 0.526830, 0.503286, 0.312226, 0.179440, 0.109140, 0.068114, 0.073872, 0.125688, 0.109209, 0.063483, 0.078976, 0.074902, 0.048985, 0.061145, 0.044165, 0.046876, 0.039973, 0.057835, 0.029931, 0.040996, 0.045161, 0.050566, 0.042235, 0.032082, 0.020011, 0.037255, 0.077936, 0.047181, 0.037362, 0.035730, 0.035150, 0.045436, 0.050355, 0.044337, 0.078095, 0.041606, 0.055516, 0.046250, 0.031578, 0.053856, 0.034707, 0.036807, 0.031010, 0.027231, 0.035225, 0.046270, 0.019425, 0.022486, 0.021249, 0.011158, 0.009750, 0.012357, 0.011702, 0.008706, 0.004675],
        [0.200378, 0.282013, 0.542122, 0.937123, 1.000000, 0.669833, 0.359089, 0.272836, 0.357189, 0.526830, 0.503286, 0.312226, 0.179440, 0.109140, 0.068114, 0.073872, 0.125688, 0.109209, 0.063483, 0.078976, 0.074902, 0.048985, 0.061145, 0.044165, 0.046876, 0.039973, 0.057835, 0.029931, 0.040996, 0.045161, 0.050566, 0.042235, 0.032082, 0.020011, 0.037255, 0.077936, 0.047181, 0.037362, 0.035730, 0.035150, 0.045436, 0.050355, 0.044337, 0.078095, 0.041606, 0.055516, 0.046250, 0.031578, 0.053856, 0.034707, 0.036807, 0.031010, 0.027231, 0.035225, 0.046270, 0.019425, 0.022486, 0.021249, 0.011158, 0.009750, 0.012357, 0.011702, 0.008706, 0.004675],
        [0.200378, 0.282013, 0.542122, 0.937123, 1.000000, 0.669833, 0.359089, 0.272836, 0.357189, 0.526830, 0.503286, 0.312226, 0.179440, 0.109140, 0.068114, 0.073872, 0.125688, 0.109209, 0.063483, 0.078976, 0.074902, 0.048985, 0.061145, 0.044165, 0.046876, 0.039973, 0.057835, 0.029931, 0.040996, 0.045161, 0.050566, 0.042235, 0.032082, 0.020011, 0.037255, 0.077936, 0.047181, 0.037362, 0.035730, 0.035150, 0.045436, 0.050355, 0.044337, 0.078095, 0.041606, 0.055516, 0.046250, 0.031578, 0.053856, 0.034707, 0.036807, 0.031010, 0.027231, 0.035225, 0.046270, 0.019425, 0.022486, 0.021249, 0.011158, 0.009750, 0.012357, 0.011702, 0.008706, 0.004675],
        [0.200378, 0.282013, 0.542122, 0.937123, 1.000000, 0.669833, 0.359089, 0.272836, 0.357189, 0.526830, 0.503286, 0.312226, 0.179440, 0.109140, 0.068114, 0.073872, 0.125688, 0.109209, 0.063483, 0.078976, 0.074902, 0.048985, 0.061145, 0.044165, 0.046876, 0.039973, 0.057835, 0.029931, 0.040996, 0.045161, 0.050566, 0.042235, 0.032082, 0.020011, 0.037255, 0.077936, 0.047181, 0.037362, 0.035730, 0.035150, 0.045436, 0.050355, 0.044337, 0.078095, 0.041606, 0.055516, 0.046250, 0.031578, 0.053856, 0.034707, 0.036807, 0.031010, 0.027231, 0.035225, 0.046270, 0.019425, 0.022486, 0.021249, 0.011158, 0.009750, 0.012357, 0.011702, 0.008706, 0.004675],
        [0.200378, 0.282013, 0.542122, 0.937123, 1.000000, 0.669833, 0.359089, 0.272836, 0.357189, 0.526830, 0.503286, 0.312226, 0.179440, 0.109140, 0.068114, 0.073872, 0.125688, 0.109209, 0.063483, 0.078976, 0.074902, 0.048985, 0.061145, 0.044165, 0.046876, 0.039973, 0.057835, 0.029931, 0.040996, 0.045161, 0.050566, 0.042235, 0.032082, 0.020011, 0.037255, 0.077936, 0.047181, 0.037362, 0.035730, 0.035150, 0.045436, 0.050355, 0.044337, 0.078095, 0.041606, 0.055516, 0.046250, 0.031578, 0.053856, 0.034707, 0.036807, 0.031010, 0.027231, 0.035225, 0.046270, 0.019425, 0.022486, 0.021249, 0.011158, 0.009750, 0.012357, 0.011702, 0.008706, 0.004675],
        [0.200378, 0.282013, 0.542122, 0.937123, 1.000000, 0.669833, 0.359089, 0.272836, 0.357189, 0.526830, 0.503286, 0.312226, 0.179440, 0.109140, 0.068114, 0.073872, 0.125688, 0.109209, 0.063483, 0.078976, 0.074902, 0.048985, 0.061145, 0.044165, 0.046876, 0.039973, 0.057835, 0.029931, 0.040996, 0.045161, 0.050566, 0.042235, 0.032082, 0.020011, 0.037255, 0.077936, 0.047181, 0.037362, 0.035730, 0.035150, 0.045436, 0.050355, 0.044337, 0.078095, 0.041606, 0.055516, 0.046250, 0.031578, 0.053856, 0.034707, 0.036807, 0.031010, 0.027231, 0.035225, 0.046270, 0.019425, 0.022486, 0.021249, 0.011158, 0.009750, 0.012357, 0.011702, 0.008706, 0.004675],
        [0.200378, 0.282013, 0.542122, 0.937123, 1.000000, 0.669833, 0.359089, 0.272836, 0.357189, 0.526830, 0.503286, 0.312226, 0.179440, 0.109140, 0.068114, 0.073872, 0.125688, 0.109209, 0.063483, 0.078976, 0.074902, 0.048985, 0.061145, 0.044165, 0.046876, 0.039973, 0.057835, 0.029931, 0.040996, 0.045161, 0.050566, 0.042235, 0.032082, 0.020011, 0.037255, 0.077936, 0.047181, 0.037362, 0.035730, 0.035150, 0.045436, 0.050355, 0.044337, 0.078095, 0.041606, 0.055516, 0.046250, 0.031578, 0.053856, 0.034707, 0.036807, 0.031010, 0.027231, 0.035225, 0.046270, 0.019425, 0.022486, 0.021249, 0.011158, 0.009750, 0.012357, 0.011702, 0.008706, 0.004675],
        [0.200378, 0.282013, 0.542122, 0.937123, 1.000000, 0.669833, 0.359089, 0.272836, 0.357189, 0.526830, 0.503286, 0.312226, 0.179440, 0.109140, 0.068114, 0.073872, 0.125688, 0.109209, 0.063483, 0.078976, 0.074902, 0.048985, 0.061145, 0.044165, 0.046876, 0.039973, 0.057835, 0.029931, 0.040996, 0.045161, 0.050566, 0.042235, 0.032082, 0.020011, 0.037255, 0.077936, 0.047181, 0.037362, 0.035730, 0.035150, 0.045436, 0.050355, 0.044337, 0.078095, 0.041606, 0.055516, 0.046250, 0.031578, 0.053856, 0.034707, 0.036807, 0.031010, 0.027231, 0.035225, 0.046270, 0.019425, 0.022486, 0.021249, 0.011158, 0.009750, 0.012357, 0.011702, 0.008706, 0.004675],
        [0.200378, 0.282013, 0.542122, 0.937123, 1.000000, 0.669833, 0.359089, 0.272836, 0.357189, 0.526830, 0.503286, 0.312226, 0.179440, 0.109140, 0.068114, 0.073872, 0.125688, 0.109209, 0.063483, 0.078976, 0.074902, 0.048985, 0.061145, 0.044165, 0.046876, 0.039973, 0.057835, 0.029931, 0.040996, 0.045161, 0.050566, 0.042235, 0.032082, 0.020011, 0.037255, 0.077936, 0.047181, 0.037362, 0.035730, 0.035150, 0.045436, 0.050355, 0.044337, 0.078095, 0.041606, 0.055516, 0.046250, 0.031578, 0.053856, 0.034707, 0.036807, 0.031010, 0.027231, 0.035225, 0.046270, 0.019425, 0.022486, 0.021249, 0.011158, 0.009750, 0.012357, 0.011702, 0.008706, 0.004675],
        [0.307938, 0.322513, 0.361429, 0.432496, 0.522951, 0.650771, 0.804849, 0.934890, 1.000000, 0.957381, 0.826601, 0.656589, 0.500956, 0.392643, 0.320361, 0.273750, 0.242903, 0.220764, 0.203371, 0.184314, 0.155127, 0.117715, 0.087720, 0.076660, 0.083853, 0.092005, 0.086559, 0.085785, 0.101626, 0.099901, 0.084348, 0.089350, 0.064314, 0.033261, 0.058540, 0.088122, 0.082847, 0.101780, 0.035665, 0.054918, 0.083491, 0.075051, 0.040073, 0.057531, 0.071317, 0.090247, 0.053445, 0.065962, 0.068310, 0.112469, 0.046693, 0.063332, 0.078693, 0.078395, 0.050339, 0.039677, 0.034165, 0.043517, 0.034151, 0.027810, 0.017624, 0.021335, 0.017565, 0.012180],
        [0.307938, 0.322513, 0.361429, 0.432496, 0.522951, 0.650771, 0.804849, 0.934890, 1.000000, 0.957381, 0.826601, 0.656589, 0.500956, 0.392643, 0.320361, 0.273750, 0.242903, 0.220764, 0.203371, 0.184314, 0.155127, 0.117715, 0.087720, 0.076660, 0.083853, 0.092005, 0.086559, 0.085785, 0.101626, 0.099901, 0.084348, 0.089350, 0.064314, 0.033261, 0.058540, 0.088122, 0.082847, 0.101780, 0.035665, 0.054918, 0.083491, 0.075051, 0.040073, 0.057531, 0.071317, 0.090247, 0.053445, 0.065962, 0.068310, 0.112469, 0.046693, 0.063332, 0.078693, 0.078395, 0.050339, 0.039677, 0.034165, 0.043517, 0.034151, 0.027810, 0.017624, 0.021335, 0.017565, 0.012180],
        [0.307938, 0.322513, 0.361429, 0.432496, 0.522951, 0.650771, 0.804849, 0.934890, 1.000000, 0.957381, 0.826601, 0.656589, 0.500956, 0.392643, 0.320361, 0.273750, 0.242903, 0.220764, 0.203371, 0.184314, 0.155127, 0.117715, 0.087720, 0.076660, 0.083853, 0.092005, 0.086559, 0.085785, 0.101626, 0.099901, 0.084348, 0.089350, 0.064314, 0.033261, 0.058540, 0.088122, 0.082847, 0.101780, 0.035665, 0.054918, 0.083491, 0.075051, 0.040073, 0.057531, 0.071317, 0.090247, 0.053445, 0.065962, 0.068310, 0.112469, 0.046693, 0.063332, 0.078693, 0.078395, 0.050339, 0.039677, 0.034165, 0.043517, 0.034151, 0.027810, 0.017624, 0.021335, 0.017565, 0.012180],
        [0.307938, 0.322513, 0.361429, 0.432496, 0.522951, 0.650771, 0.804849, 0.934890, 1.000000, 0.957381, 0.826601, 0.656589, 0.500956, 0.392643, 0.320361, 0.273750, 0.242903, 0.220764, 0.203371, 0.184314, 0.155127, 0.117715, 0.087720, 0.076660, 0.083853, 0.092005, 0.086559, 0.085785, 0.101626, 0.099901, 0.084348, 0.089350, 0.064314, 0.033261, 0.058540, 0.088122, 0.082847, 0.101780, 0.035665, 0.054918, 0.083491, 0.075051, 0.040073, 0.057531, 0.071317, 0.090247, 0.053445, 0.065962, 0.068310, 0.112469, 0.046693, 0.063332, 0.078693, 0.078395, 0.050339, 0.039677, 0.034165, 0.043517, 0.034151, 0.027810, 0.017624, 0.021335, 0.017565, 0.012180],
        [0.307938, 0.322513, 0.361429, 0.432496, 0.522951, 0.650771, 0.804849, 0.934890, 1.000000, 0.957381, 0.826601, 0.656589, 0.500956, 0.392643, 0.320361, 0.273750, 0.242903, 0.220764, 0.203371, 0.184314, 0.155127, 0.117715, 0.087720, 0.076660, 0.083853, 0.092005, 0.086559, 0.085785, 0.101626, 0.099901, 0.084348, 0.089350, 0.064314, 0.033261, 0.058540, 0.088122, 0.082847, 0.101780, 0.035665, 0.054918, 0.083491, 0.075051, 0.040073, 0.057531, 0.071317, 0.090247, 0.053445, 0.065962, 0.068310, 0.112469, 0.046693, 0.063332, 0.078693, 0.078395, 0.050339, 0.039677, 0.034165, 0.043517, 0.034151, 0.027810, 0.017624, 0.021335, 0.017565, 0.012180],
        [0.307938, 0.322513, 0.361429, 0.432496, 0.522951, 0.650771, 0.804849, 0.934890, 1.000000, 0.957381, 0.826601, 0.656589, 0.500956, 0.392643, 0.320361, 0.273750, 0.242903, 0.220764, 0.203371, 0.184314, 0.155127, 0.117715, 0.087720, 0.076660, 0.083853, 0.092005, 0.086559, 0.085785, 0.101626, 0.099901, 0.084348, 0.089350, 0.064314, 0.033261, 0.058540, 0.088122, 0.082847, 0.101780, 0.035665, 0.054918, 0.083491, 0.075051, 0.040073, 0.057531, 0.071317, 0.090247, 0.053445, 0.065962, 0.068310, 0.112469, 0.046693, 0.063332, 0.078693, 0.078395, 0.050339, 0.039677, 0.034165, 0.043517, 0.034151, 0.027810, 0.017624, 0.021335, 0.017565, 0.012180],
        [0.307938, 0.322513, 0.361429, 0.432496, 0.522951, 0.650771, 0.804849, 0.934890, 1.000000, 0.957381, 0.826601, 0.656589, 0.500956, 0.392643, 0.320361, 0.273750, 0.242903, 0.220764, 0.203371, 0.184314, 0.155127, 0.117715, 0.087720, 0.076660, 0.083853, 0.092005, 0.086559, 0.085785, 0.101626, 0.099901, 0.084348, 0.089350, 0.064314, 0.033261, 0.058540, 0.088122, 0.082847, 0.101780, 0.035665, 0.054918, 0.083491, 0.075051, 0.040073, 0.057531, 0.071317, 0.090247, 0.053445, 0.065962, 0.068310, 0.112469, 0.046693, 0.063332, 0.078693, 0.078395, 0.050339, 0.039677, 0.034165, 0.043517, 0.034151, 0.027810, 0.017624, 0.021335, 0.017565, 0.012180],
        [0.307938, 0.322513, 0.361429, 0.432496, 0.522951, 0.650771, 0.804849, 0.934890, 1.000000, 0.957381, 0.826601, 0.656589, 0.500956, 0.392643, 0.320361, 0.273750, 0.242903, 0.220764, 0.203371, 0.184314, 0.155127, 0.117715, 0.087720, 0.076660, 0.083853, 0.092005, 0.086559, 0.085785, 0.101626, 0.099901, 0.084348, 0.089350, 0.064314, 0.033261, 0.058540, 0.088122, 0.082847, 0.101780, 0.035665, 0.054918, 0.083491, 0.075051, 0.040073, 0.057531, 0.071317, 0.090247, 0.053445, 0.065962, 0.068310, 0.112469, 0.046693, 0.063332, 0.078693, 0.078395, 0.050339, 0.039677, 0.034165, 0.043517, 0.034151, 0.027810, 0.017624, 0.021335, 0.017565, 0.012180],
        [0.307938, 0.322513, 0.361429, 0.432496, 0.522951, 0.650771, 0.804849, 0.934890, 1.000000, 0.957381, 0.826601, 0.656589, 0.500956, 0.392643, 0.320361, 0.273750, 0.242903, 0.220764, 0.203371, 0.184314, 0.155127, 0.117715, 0.087720, 0.076660, 0.083853, 0.092005, 0.086559, 0.085785, 0.101626, 0.099901, 0.084348, 0.089350, 0.064314, 0.033261, 0.058540, 0.088122, 0.082847, 0.101780, 0.035665, 0.054918, 0.083491, 0.075051, 0.040073, 0.057531, 0.071317, 0.090247, 0.053445, 0.065962, 0.068310, 0.112469, 0.046693, 0.063332, 0.078693, 0.078395, 0.050339, 0.039677, 0.034165, 0.043517, 0.034151, 0.027810, 0.017624, 0.021335, 0.017565, 0.012180],
        [0.307938, 0.322513, 0.361429, 0.432496, 0.522951, 0.650771, 0.804849, 0.934890, 1.000000, 0.957381, 0.826601, 0.656589, 0.500956, 0.392643, 0.320361, 0.273750, 0.242903, 0.220764, 0.203371, 0.184314, 0.155127, 0.117715, 0.087720, 0.076660, 0.083853, 0.092005, 0.086559, 0.085785, 0.101626, 0.099901, 0.084348, 0.089350, 0.064314, 0.033261, 0.058540, 0.088122, 0.082847, 0.101780, 0.035665, 0.054918, 0.083491, 0.075051, 0.040073, 0.057531, 0.071317, 0.090247, 0.053445, 0.065962, 0.068310, 0.112469, 0.046693, 0.063332, 0.078693, 0.078395, 0.050339, 0.039677, 0.034165, 0.043517, 0.034151, 0.027810, 0.017624, 0.021335, 0.017565, 0.012180],
        [0.307938, 0.322513, 0.361429, 0.432496, 0.522951, 0.650771, 0.804849, 0.934890, 1.000000, 0.957381, 0.826601, 0.656589, 0.500956, 0.392643, 0.320361, 0.273750, 0.242903, 0.220764, 0.203371, 0.184314, 0.155127, 0.117715, 0.087720, 0.076660, 0.083853, 0.092005, 0.086559, 0.085785, 0.101626, 0.099901, 0.084348, 0.089350, 0.064314, 0.033261, 0.058540, 0.088122, 0.082847, 0.101780, 0.035665, 0.054918, 0.083491, 0.075051, 0.040073, 0.057531, 0.071317, 0.090247, 0.053445, 0.065962, 0.068310, 0.112469, 0.046693, 0.063332, 0.078693, 0.078395, 0.050339, 0.039677, 0.034165, 0.043517, 0.034151, 0.027810, 0.017624, 0.021335, 0.017565, 0.012180],
        [0.307938, 0.322513, 0.361429, 0.432496, 0.522951, 0.650771, 0.804849, 0.934890, 1.000000, 0.957381, 0.826601, 0.656589, 0.500956, 0.392643, 0.320361, 0.273750, 0.242903, 0.220764, 0.203371, 0.184314, 0.155127, 0.117715, 0.087720, 0.076660, 0.083853, 0.092005, 0.086559, 0.085785, 0.101626, 0.099901, 0.084348, 0.089350, 0.064314, 0.033261, 0.058540, 0.088122, 0.082847, 0.101780, 0.035665, 0.054918, 0.083491, 0.075051, 0.040073, 0.057531, 0.071317, 0.090247, 0.053445, 0.065962, 0.068310, 0.112469, 0.046693, 0.063332, 0.078693, 0.078395, 0.050339, 0.039677, 0.034165, 0.043517, 0.034151, 0.027810, 0.017624, 0.021335, 0.017565, 0.012180],
        [0.950827, 0.952489, 0.956634, 0.963440, 0.970987, 0.980206, 0.989908, 0.997221, 1.000000, 0.994141, 0.976463, 0.942285, 0.888936, 0.821214, 0.738332, 0.646020, 0.551690, 0.462552, 0.384377, 0.319868, 0.270047, 0.234061, 0.211169, 0.200277, 0.201681, 0.213177, 0.228126, 0.231000, 0.206113, 0.161842, 0.124313, 0.114420, 0.142130, 0.194204, 0.194364, 0.118646, 0.068841, 0.076481, 0.131631, 0.156365, 0.125620, 0.115408, 0.103836, 0.101251, 0.132330, 0.094633, 0.092095, 0.123912, 0.095676, 0.178548, 0.114326, 0.066725, 0.075763, 0.121136, 0.096280, 0.050853, 0.079216, 0.034775, 0.039218, 0.035903, 0.032956, 0.029297, 0.018401, 0.014322],
        [0.950827, 0.952489, 0.956634, 0.963440, 0.970987, 0.980206, 0.989908, 0.997221, 1.000000, 0.994141, 0.976463, 0.942285, 0.888936, 0.821214, 0.738332, 0.646020, 0.551690, 0.462552, 0.384377, 0.319868, 0.270047, 0.234061, 0.211169, 0.200277, 0.201681, 0.213177, 0.228126, 0.231000, 0.206113, 0.161842, 0.124313, 0.114420, 0.142130, 0.194204, 0.194364, 0.118646, 0.068841, 0.076481, 0.131631, 0.156365, 0.125620, 0.115408, 0.103836, 0.101251, 0.132330, 0.094633, 0.092095, 0.123912, 0.095676, 0.178548, 0.114326, 0.066725, 0.075763, 0.121136, 0.096280, 0.050853, 0.079216, 0.034775, 0.039218, 0.035903, 0.032956, 0.029297, 0.018401, 0.014322],
        [0.950827, 0.952489, 0.956634, 0.963440, 0.970987, 0.980206, 0.989908, 0.997221, 1.000000, 0.994141, 0.976463, 0.942285, 0.888936, 0.821214, 0.738332, 0.646020, 0.551690, 0.462552, 0.384377, 0.319868, 0.270047, 0.234061, 0.211169, 0.200277, 0.201681, 0.213177, 0.228126, 0.231000, 0.206113, 0.161842, 0.124313, 0.114420, 0.142130, 0.194204, 0.194364, 0.118646, 0.068841, 0.076481, 0.131631, 0.156365, 0.125620, 0.115408, 0.103836, 0.101251, 0.132330, 0.094633, 0.092095, 0.123912, 0.095676, 0.178548, 0.114326, 0.066725, 0.075763, 0.121136, 0.096280, 0.050853, 0.079216, 0.034775, 0.039218, 0.035903, 0.032956, 0.029297, 0.018401, 0.014322],
        [0.950827, 0.952489, 0.956634, 0.963440, 0.970987, 0.980206, 0.989908, 0.997221, 1.000000, 0.994141, 0.976463, 0.942285, 0.888936, 0.821214, 0.738332, 0.646020, 0.551690, 0.462552, 0.384377, 0.319868, 0.270047, 0.234061, 0.211169, 0.200277, 0.201681, 0.213177, 0.228126, 0.231000, 0.206113, 0.161842, 0.124313, 0.114420, 0.142130, 0.194204, 0.194364, 0.118646, 0.068841, 0.076481, 0.131631, 0.156365, 0.125620, 0.115408, 0.103836, 0.101251, 0.132330, 0.094633, 0.092095, 0.123912, 0.095676, 0.178548, 0.114326, 0.066725, 0.075763, 0.121136, 0.096280, 0.050853, 0.079216, 0.034775, 0.039218, 0.035903, 0.032956, 0.029297, 0.018401, 0.014322],
        [0.950827, 0.952489, 0.956634, 0.963440, 0.970987, 0.980206, 0.989908, 0.997221, 1.000000, 0.994141, 0.976463, 0.942285, 0.888936, 0.821214, 0.738332, 0.646020, 0.551690, 0.462552, 0.384377, 0.319868, 0.270047, 0.234061, 0.211169, 0.200277, 0.201681, 0.213177, 0.228126, 0.231000, 0.206113, 0.161842, 0.124313, 0.114420, 0.142130, 0.194204, 0.194364, 0.118646, 0.068841, 0.076481, 0.131631, 0.156365, 0.125620, 0.115408, 0.103836, 0.101251, 0.132330, 0.094633, 0.092095, 0.123912, 0.095676, 0.178548, 0.114326, 0.066725, 0.075763, 0.121136, 0.096280, 0.050853, 0.079216, 0.034775, 0.039218, 0.035903, 0.032956, 0.029297, 0.018401, 0.014322],
        [0.950827, 0.952489, 0.956634, 0.963440, 0.970987, 0.980206, 0.989908, 0.997221, 1.000000, 0.994141, 0.976463, 0.942285, 0.888936, 0.821214, 0.738332, 0.646020, 0.551690, 0.462552, 0.384377, 0.319868, 0.270047, 0.234061, 0.211169, 0.200277, 0.201681, 0.213177, 0.228126, 0.231000, 0.206113, 0.161842, 0.124313, 0.114420, 0.142130, 0.194204, 0.194364, 0.118646, 0.068841, 0.076481, 0.131631, 0.156365, 0.125620, 0.115408, 0.103836, 0.101251, 0.132330, 0.094633, 0.092095, 0.123912, 0.095676, 0.178548, 0.114326, 0.066725, 0.075763, 0.121136, 0.096280, 0.050853, 0.079216, 0.034775, 0.039218, 0.035903, 0.032956, 0.029297, 0.018401, 0.014322],
        [0.950827, 0.952489, 0.956634, 0.963440, 0.970987, 0.980206, 0.989908, 0.997221, 1.000000, 0.994141, 0.976463, 0.942285, 0.888936, 0.821214, 0.738332, 0.646020, 0.551690, 0.462552, 0.384377, 0.319868, 0.270047, 0.234061, 0.211169, 0.200277, 0.201681, 0.213177, 0.228126, 0.231000, 0.206113, 0.161842, 0.124313, 0.114420, 0.142130, 0.194204, 0.194364, 0.118646, 0.068841, 0.076481, 0.131631, 0.156365, 0.125620, 0.115408, 0.103836, 0.101251, 0.132330, 0.094633, 0.092095, 0.123912, 0.095676, 0.178548, 0.114326, 0.066725, 0.075763, 0.121136, 0.096280, 0.050853, 0.079216, 0.034775, 0.039218, 0.035903, 0.032956, 0.029297, 0.018401, 0.014322],
        [0.950827, 0.952489, 0.956634, 0.963440, 0.970987, 0.980206, 0.989908, 0.997221, 1.000000, 0.994141, 0.976463, 0.942285, 0.888936, 0.821214, 0.738332, 0.646020, 0.551690, 0.462552, 0.384377, 0.319868, 0.270047, 0.234061, 0.211169, 0.200277, 0.201681, 0.213177, 0.228126, 0.231000, 0.206113, 0.161842, 0.124313, 0.114420, 0.142130, 0.194204, 0.194364, 0.118646, 0.068841, 0.076481, 0.131631, 0.156365, 0.125620, 0.115408, 0.103836, 0.101251, 0.132330, 0.094633, 0.092095, 0.123912, 0.095676, 0.178548, 0.114326, 0.066725, 0.075763, 0.121136, 0.096280, 0.050853, 0.079216, 0.034775, 0.039218, 0.035903, 0.032956, 0.029297, 0.018401, 0.014322],
        [0.950827, 0.952489, 0.956634, 0.963440, 0.970987, 0.980206, 0.989908, 0.997221, 1.000000, 0.994141, 0.976463, 0.942285, 0.888936, 0.821214, 0.738332, 0.646020, 0.551690, 0.462552, 0.384377, 0.319868, 0.270047, 0.234061, 0.211169, 0.200277, 0.201681, 0.213177, 0.228126, 0.231000, 0.206113, 0.161842, 0.124313, 0.114420, 0.142130, 0.194204, 0.194364, 0.118646, 0.068841, 0.076481, 0.131631, 0.156365, 0.125620, 0.115408, 0.103836, 0.101251, 0.132330, 0.094633, 0.092095, 0.123912, 0.095676, 0.178548, 0.114326, 0.066725, 0.075763, 0.121136, 0.096280, 0.050853, 0.079216, 0.034775, 0.039218, 0.035903, 0.032956, 0.029297, 0.018401, 0.014322],
        [0.950827, 0.952489, 0.956634, 0.963440, 0.970987, 0.980206, 0.989908, 0.997221, 1.000000, 0.994141, 0.976463, 0.942285, 0.888936, 0.821214, 0.738332, 0.646020, 0.551690, 0.462552, 0.384377, 0.319868, 0.270047, 0.234061, 0.211169, 0.200277, 0.201681, 0.213177, 0.228126, 0.231000, 0.206113, 0.161842, 0.124313, 0.114420, 0.142130, 0.194204, 0.194364, 0.118646, 0.068841, 0.076481, 0.131631, 0.156365, 0.125620, 0.115408, 0.103836, 0.101251, 0.132330, 0.094633, 0.092095, 0.123912, 0.095676, 0.178548, 0.114326, 0.066725, 0.075763, 0.121136, 0.096280, 0.050853, 0.079216, 0.034775, 0.039218, 0.035903, 0.032956, 0.029297, 0.018401, 0.014322],
        [0.950827, 0.952489, 0.956634, 0.963440, 0.970987, 0.980206, 0.989908, 0.997221, 1.000000, 0.994141, 0.976463, 0.942285, 0.888936, 0.821214, 0.738332, 0.646020, 0.551690, 0.462552, 0.384377, 0.319868, 0.270047, 0.234061, 0.211169, 0.200277, 0.201681, 0.213177, 0.228126, 0.231000, 0.206113, 0.161842, 0.124313, 0.114420, 0.142130, 0.194204, 0.194364, 0.118646, 0.068841, 0.076481, 0.131631, 0.156365, 0.125620, 0.115408, 0.103836, 0.101251, 0.132330, 0.094633, 0.092095, 0.123912, 0.095676, 0.178548, 0.114326, 0.066725, 0.075763, 0.121136, 0.096280, 0.050853, 0.079216, 0.034775, 0.039218, 0.035903, 0.032956, 0.029297, 0.018401, 0.014322],
        [0.950827, 0.952489, 0.956634, 0.963440, 0.970987, 0.980206, 0.989908, 0.997221, 1.000000, 0.994141, 0.976463, 0.942285, 0.888936, 0.821214, 0.738332, 0.646020, 0.551690, 0.462552, 0.384377, 0.319868, 0.270047, 0.234061, 0.211169, 0.200277, 0.201681, 0.213177, 0.228126, 0.231000, 0.206113, 0.161842, 0.124313, 0.114420, 0.142130, 0.194204, 0.194364, 0.118646, 0.068841, 0.076481, 0.131631, 0.156365, 0.125620, 0.115408, 0.103836, 0.101251, 0.132330, 0.094633, 0.092095, 0.123912, 0.095676, 0.178548, 0.114326, 0.066725, 0.075763, 0.121136, 0.096280, 0.050853, 0.079216, 0.034775, 0.039218, 0.035903, 0.032956, 0.029297, 0.018401, 0.014322],
        [1.000000, 0.998415, 0.994330, 0.987207, 0.978489, 0.966079, 0.949304, 0.929500, 0.904427, 0.873633, 0.839652, 0.799816, 0.754270, 0.706823, 0.654909, 0.599501, 0.541904, 0.483637, 0.426460, 0.371974, 0.321778, 0.276927, 0.238290, 0.204944, 0.178548, 0.158744, 0.144471, 0.135598, 0.131746, 0.132118, 0.135405, 0.139706, 0.142054, 0.139808, 0.131554, 0.118343, 0.103931, 0.091795, 0.084241, 0.081933, 0.083855, 0.087787, 0.090879, 0.090968, 0.087148, 0.080299, 0.074033, 0.074345, 0.085243, 0.096745, 0.085614, 0.065129, 0.070458, 0.101532, 0.089487, 0.053366, 0.050339, 0.042231, 0.031691, 0.039279, 0.026118, 0.030892, 0.025939, 0.018271],
        [1.000000, 0.998415, 0.994330, 0.987207, 0.978489, 0.966079, 0.949304, 0.929500, 0.904427, 0.873633, 0.839652, 0.799816, 0.754270, 0.706823, 0.654909, 0.599501, 0.541904, 0.483637, 0.426460, 0.371974, 0.321778, 0.276927, 0.238290, 0.204944, 0.178548, 0.158744, 0.144471, 0.135598, 0.131746, 0.132118, 0.135405, 0.139706, 0.142054, 0.139808, 0.131554, 0.118343, 0.103931, 0.091795, 0.084241, 0.081933, 0.083855, 0.087787, 0.090879, 0.090968, 0.087148, 0.080299, 0.074033, 0.074345, 0.085243, 0.096745, 0.085614, 0.065129, 0.070458, 0.101532, 0.089487, 0.053366, 0.050339, 0.042231, 0.031691, 0.039279, 0.026118, 0.030892, 0.025939, 0.018271],
        [1.000000, 0.998415, 0.994330, 0.987207, 0.978489, 0.966079, 0.949304, 0.929500, 0.904427, 0.873633, 0.839652, 0.799816, 0.754270, 0.706823, 0.654909, 0.599501, 0.541904, 0.483637, 0.426460, 0.371974, 0.321778, 0.276927, 0.238290, 0.204944, 0.178548, 0.158744, 0.144471, 0.135598, 0.131746, 0.132118, 0.135405, 0.139706, 0.142054, 0.139808, 0.131554, 0.118343, 0.103931, 0.091795, 0.084241, 0.081933, 0.083855, 0.087787, 0.090879, 0.090968, 0.087148, 0.080299, 0.074033, 0.074345, 0.085243, 0.096745, 0.085614, 0.065129, 0.070458, 0.101532, 0.089487, 0.053366, 0.050339, 0.042231, 0.031691, 0.039279, 0.026118, 0.030892, 0.025939, 0.018271],
        [1.000000, 0.998415, 0.994330, 0.987207, 0.978489, 0.966079, 0.949304, 0.929500, 0.904427, 0.873633, 0.839652, 0.799816, 0.754270, 0.706823, 0.654909, 0.599501, 0.541904, 0.483637, 0.426460, 0.371974, 0.321778, 0.276927, 0.238290, 0.204944, 0.178548, 0.158744, 0.144471, 0.135598, 0.131746, 0.132118, 0.135405, 0.139706, 0.142054, 0.139808, 0.131554, 0.118343, 0.103931, 0.091795, 0.084241, 0.081933, 0.083855, 0.087787, 0.090879, 0.090968, 0.087148, 0.080299, 0.074033, 0.074345, 0.085243, 0.096745, 0.085614, 0.065129, 0.070458, 0.101532, 0.089487, 0.053366, 0.050339, 0.042231, 0.031691, 0.039279, 0.026118, 0.030892, 0.025939, 0.018271],
        [1.000000, 0.998415, 0.994330, 0.987207, 0.978489, 0.966079, 0.949304, 0.929500, 0.904427, 0.873633, 0.839652, 0.799816, 0.754270, 0.706823, 0.654909, 0.599501, 0.541904, 0.483637, 0.426460, 0.371974, 0.321778, 0.276927, 0.238290, 0.204944, 0.178548, 0.158744, 0.144471, 0.135598, 0.131746, 0.132118, 0.135405, 0.139706, 0.142054, 0.139808, 0.131554, 0.118343, 0.103931, 0.091795, 0.084241, 0.081933, 0.083855, 0.087787, 0.090879, 0.090968, 0.087148, 0.080299, 0.074033, 0.074345, 0.085243, 0.096745, 0.085614, 0.065129, 0.070458, 0.101532, 0.089487, 0.053366, 0.050339, 0.042231, 0.031691, 0.039279, 0.026118, 0.030892, 0.025939, 0.018271],
        [1.000000, 0.998415, 0.994330, 0.987207, 0.978489, 0.966079, 0.949304, 0.929500, 0.904427, 0.873633, 0.839652, 0.799816, 0.754270, 0.706823, 0.654909, 0.599501, 0.541904, 0.483637, 0.426460, 0.371974, 0.321778, 0.276927, 0.238290, 0.204944, 0.178548, 0.158744, 0.144471, 0.135598, 0.131746, 0.132118, 0.135405, 0.139706, 0.142054, 0.139808, 0.131554, 0.118343, 0.103931, 0.091795, 0.084241, 0.081933, 0.083855, 0.087787, 0.090879, 0.090968, 0.087148, 0.080299, 0.074033, 0.074345, 0.085243, 0.096745, 0.085614, 0.065129, 0.070458, 0.101532, 0.089487, 0.053366, 0.050339, 0.042231, 0.031691, 0.039279, 0.026118, 0.030892, 0.025939, 0.018271]
    ])
    freqs: np.ndarray = np.array([
           0,    4,    7,   12,   16,   20,   25,   30,   35,   41,
          47,   53,   60,   67,   74,   82,   90,   99,  108,  118,
         128,  139,  150,  162,  175,  188,  202,  217,  233,  250,
         267,  286,  306,  326,  348,  371,  396,  421,  449,  477,
         508,  540,  574,  609,  647,  687,  729,  773,  820,  869,
         922,  977, 1035, 1097, 1161, 1230, 1302, 1379, 1460, 1545,
        1635, 1730, 1830, 1936, 2048
    ])
    z = plucked_string_frequency_filter(z, note_no, LOWEST_NOTE_NO, N_FFT, N_BAND, WIN_LEN, amps, freqs, duration, sr)

    # parts
    p_vcf_a: dict[str, float] = {'A': 0, 'D': 5/freq, 'S': 0, 'R': 5/freq,
                                 'gate': gate, 'dur': duration, 'offset': 32*freq, 'depth': 512*freq}
    p_vca_a: dict[str, float] = {'A': 1/freq, 'D': 20/freq, 'S': 0, 'R': 20/freq,
                                 'gate': gate, 'dur': duration, 'offset': 0, 'depth': 1}
    za: np.ndarray = plucked_string_part(z, p_vcf_a, p_vca_a, sr)

    p_vcf_s: dict[str, float] = {'A': 0, 'D': 0.2*fbk_decay, 'S': 0, 'R': 0.2*fbk_decay,
                                 'gate': gate, 'dur': duration, 'offset': 8*freq, 'depth': 128*freq}
    p_vca_s: dict[str, float] = {'A': 1/freq, 'D': 0, 'S': 1, 'R': 0,
                                 'gate': duration, 'dur': duration, 'offset': 0, 'depth': 1}
    zs: np.ndarray = plucked_string_part(z, p_vcf_s, p_vca_s, sr)

    vca: np.ndarray = adsr(A=0, D=0, S=1, R=0.1, gate=gate, dur=duration, sr=sr)
    z = vca * (0.5 * za + 0.5 * zs)
    return (velocity / 127) / np.max(np.abs(z)) * z